{"ast":null,"code":"var _jsxFileName = \"C:\\\\Users\\\\yasha\\\\Downloads\\\\react.js learning\\\\Event Management\\\\frontend\\\\src\\\\screens\\\\QrVerifyScreen.js\",\n  _s = $RefreshSig$();\nimport React, { useEffect, useRef, useState } from \"react\";\nimport { Html5QrcodeScanner } from \"html5-qrcode\";\nimport { useDispatch } from \"react-redux\";\nimport { verifyTicket } from \"../actions/eventActions\";\nimport { jsxDEV as _jsxDEV } from \"react/jsx-dev-runtime\";\nexport default function QrVerifyScreen() {\n  _s();\n  var _result$ticket, _result$ticket$event;\n  const [result, setResult] = useState(null);\n  const [error, setError] = useState(null);\n  const [scanning, setScanning] = useState(true);\n  const scannerRef = useRef(null);\n  const dispatch = useDispatch();\n  useEffect(() => {\n    let mounted = true;\n    let scanner;\n    const init = async () => {\n      try {\n        scanner = new Html5QrcodeScanner(\"qr-reader\", {\n          fps: 10,\n          qrbox: 250\n        });\n        scanner.render(async text => {\n          if (!mounted) return;\n          setError(null);\n          setResult(null);\n          setScanning(true);\n          try {\n            var _dispatched$data;\n            const dispatched = await dispatch(verifyTicket(text));\n            const data = (_dispatched$data = dispatched === null || dispatched === void 0 ? void 0 : dispatched.data) !== null && _dispatched$data !== void 0 ? _dispatched$data : dispatched;\n            setResult(data);\n            // stop scanning after a successful attempt\n            setScanning(false);\n            await scanner.clear();\n          } catch (e) {\n            var _e$response, _e$response$data;\n            setError((e === null || e === void 0 ? void 0 : (_e$response = e.response) === null || _e$response === void 0 ? void 0 : (_e$response$data = _e$response.data) === null || _e$response$data === void 0 ? void 0 : _e$response$data.detail) || e.message || String(e));\n          }\n        }, () => {});\n        scannerRef.current = scanner;\n      } catch (err) {\n        setError((err === null || err === void 0 ? void 0 : err.message) || String(err));\n      }\n    };\n    init();\n    return () => {\n      mounted = false;\n      if (scannerRef.current && scannerRef.current.clear) {\n        scannerRef.current.clear().catch(() => {});\n      }\n    };\n  }, [dispatch]);\n  const submitManual = async e => {\n    e.preventDefault();\n    const id = e.target.elements.ticket.value;\n    if (!id) return setError(\"Please enter a ticket id\");\n    try {\n      var _dispatched$data2;\n      setError(null);\n      setResult(null);\n      const dispatched = await dispatch(verifyTicket(id));\n      const data = (_dispatched$data2 = dispatched === null || dispatched === void 0 ? void 0 : dispatched.data) !== null && _dispatched$data2 !== void 0 ? _dispatched$data2 : dispatched;\n      setResult(data);\n    } catch (e2) {\n      var _e2$response, _e2$response$data;\n      setError((e2 === null || e2 === void 0 ? void 0 : (_e2$response = e2.response) === null || _e2$response === void 0 ? void 0 : (_e2$response$data = _e2$response.data) === null || _e2$response$data === void 0 ? void 0 : _e2$response$data.detail) || e2.message || String(e2));\n    }\n  };\n  const restartScanner = async () => {\n    setError(null);\n    setResult(null);\n    setScanning(true);\n    // re-create scanner by reloading component: simple approach - clear then init again\n    if (scannerRef.current && scannerRef.current.clear) {\n      await scannerRef.current.clear().catch(() => {});\n    }\n    window.location.reload(); // simple and reliable fallback to restart scanner UI\n  };\n  return /*#__PURE__*/_jsxDEV(\"div\", {\n    children: [/*#__PURE__*/_jsxDEV(\"h3\", {\n      children: \"Verify Ticket\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 83,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      id: \"qr-reader\"\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 84,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"mt-2\",\n      children: scanning ? /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"small text-muted\",\n        children: \"Scanner active \\u2014 point camera at QR code\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 21\n      }, this) : /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"small text-muted\",\n        children: \"Scanner stopped\"\n      }, void 0, false, {\n        fileName: _jsxFileName,\n        lineNumber: 86,\n        columnNumber: 104\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 85,\n      columnNumber: 7\n    }, this), /*#__PURE__*/_jsxDEV(\"form\", {\n      className: \"mt-3\",\n      onSubmit: submitManual,\n      children: /*#__PURE__*/_jsxDEV(\"div\", {\n        className: \"input-group\",\n        children: [/*#__PURE__*/_jsxDEV(\"input\", {\n          name: \"ticket\",\n          className: \"form-control\",\n          placeholder: \"Enter ticket ID\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 91,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          className: \"btn btn-primary\",\n          type: \"submit\",\n          children: \"Verify\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 92,\n          columnNumber: 11\n        }, this), /*#__PURE__*/_jsxDEV(\"button\", {\n          type: \"button\",\n          className: \"btn btn-outline-secondary\",\n          onClick: restartScanner,\n          children: \"Restart Scanner\"\n        }, void 0, false, {\n          fileName: _jsxFileName,\n          lineNumber: 93,\n          columnNumber: 11\n        }, this)]\n      }, void 0, true, {\n        fileName: _jsxFileName,\n        lineNumber: 90,\n        columnNumber: 9\n      }, this)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 89,\n      columnNumber: 7\n    }, this), error && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: \"alert alert-danger mt-3\",\n      children: String(error)\n    }, void 0, false, {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 17\n    }, this), result && /*#__PURE__*/_jsxDEV(\"div\", {\n      className: `alert mt-3 ${result.valid ? \"alert-success\" : \"alert-warning\"}`,\n      children: [result.valid ? \"Valid\" : \"Invalid\", \" \\u2014 \", ((_result$ticket = result.ticket) === null || _result$ticket === void 0 ? void 0 : (_result$ticket$event = _result$ticket.event) === null || _result$ticket$event === void 0 ? void 0 : _result$ticket$event.title) || result.detail]\n    }, void 0, true, {\n      fileName: _jsxFileName,\n      lineNumber: 99,\n      columnNumber: 9\n    }, this)]\n  }, void 0, true, {\n    fileName: _jsxFileName,\n    lineNumber: 82,\n    columnNumber: 5\n  }, this);\n}\n_s(QrVerifyScreen, \"2MEY59um5nkoBdNPRKp/NADkfL0=\", false, function () {\n  return [useDispatch];\n});\n_c = QrVerifyScreen;\nvar _c;\n$RefreshReg$(_c, \"QrVerifyScreen\");","map":{"version":3,"names":["React","useEffect","useRef","useState","Html5QrcodeScanner","useDispatch","verifyTicket","jsxDEV","_jsxDEV","QrVerifyScreen","_s","_result$ticket","_result$ticket$event","result","setResult","error","setError","scanning","setScanning","scannerRef","dispatch","mounted","scanner","init","fps","qrbox","render","text","_dispatched$data","dispatched","data","clear","e","_e$response","_e$response$data","response","detail","message","String","current","err","catch","submitManual","preventDefault","id","target","elements","ticket","value","_dispatched$data2","e2","_e2$response","_e2$response$data","restartScanner","window","location","reload","children","fileName","_jsxFileName","lineNumber","columnNumber","className","onSubmit","name","placeholder","type","onClick","valid","event","title","_c","$RefreshReg$"],"sources":["C:/Users/yasha/Downloads/react.js learning/Event Management/frontend/src/screens/QrVerifyScreen.js"],"sourcesContent":["import React, { useEffect, useRef, useState } from \"react\";\nimport { Html5QrcodeScanner } from \"html5-qrcode\";\nimport { useDispatch } from \"react-redux\";\nimport { verifyTicket } from \"../actions/eventActions\";\n\nexport default function QrVerifyScreen() {\n  const [result, setResult] = useState(null);\n  const [error, setError] = useState(null);\n  const [scanning, setScanning] = useState(true);\n  const scannerRef = useRef(null);\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    let mounted = true;\n    let scanner;\n\n    const init = async () => {\n      try {\n        scanner = new Html5QrcodeScanner(\"qr-reader\", { fps: 10, qrbox: 250 });\n        scanner.render(\n          async (text) => {\n            if (!mounted) return;\n            setError(null);\n            setResult(null);\n            setScanning(true);\n            try {\n              const dispatched = await dispatch(verifyTicket(text));\n              const data = dispatched?.data ?? dispatched;\n              setResult(data);\n              // stop scanning after a successful attempt\n              setScanning(false);\n              await scanner.clear();\n            } catch (e) {\n              setError(e?.response?.data?.detail || e.message || String(e));\n            }\n          },\n          () => {}\n        );\n        scannerRef.current = scanner;\n      } catch (err) {\n        setError(err?.message || String(err));\n      }\n    };\n\n    init();\n\n    return () => {\n      mounted = false;\n      if (scannerRef.current && scannerRef.current.clear) {\n        scannerRef.current.clear().catch(() => {});\n      }\n    };\n  }, [dispatch]);\n\n  const submitManual = async (e) => {\n    e.preventDefault();\n    const id = e.target.elements.ticket.value;\n    if (!id) return setError(\"Please enter a ticket id\");\n    try {\n      setError(null);\n      setResult(null);\n      const dispatched = await dispatch(verifyTicket(id));\n      const data = dispatched?.data ?? dispatched;\n      setResult(data);\n    } catch (e2) {\n      setError(e2?.response?.data?.detail || e2.message || String(e2));\n    }\n  };\n\n  const restartScanner = async () => {\n    setError(null);\n    setResult(null);\n    setScanning(true);\n    // re-create scanner by reloading component: simple approach - clear then init again\n    if (scannerRef.current && scannerRef.current.clear) {\n      await scannerRef.current.clear().catch(() => {});\n    }\n    window.location.reload(); // simple and reliable fallback to restart scanner UI\n  };\n\n  return (\n    <div>\n      <h3>Verify Ticket</h3>\n      <div id=\"qr-reader\" />\n      <div className=\"mt-2\">\n        {scanning ? <div className=\"small text-muted\">Scanner active — point camera at QR code</div> : <div className=\"small text-muted\">Scanner stopped</div>}\n      </div>\n\n      <form className=\"mt-3\" onSubmit={submitManual}>\n        <div className=\"input-group\">\n          <input name=\"ticket\" className=\"form-control\" placeholder=\"Enter ticket ID\" />\n          <button className=\"btn btn-primary\" type=\"submit\">Verify</button>\n          <button type=\"button\" className=\"btn btn-outline-secondary\" onClick={restartScanner}>Restart Scanner</button>\n        </div>\n      </form>\n\n      {error && <div className=\"alert alert-danger mt-3\">{String(error)}</div>}\n      {result && (\n        <div className={`alert mt-3 ${result.valid ? \"alert-success\" : \"alert-warning\"}`}>\n          {result.valid ? \"Valid\" : \"Invalid\"} — {result.ticket?.event?.title || result.detail}\n        </div>\n      )}\n    </div>\n  );\n}\n\n\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}